---
title: "p8105_hw1_yh3554"
output: github_document
---

```{r, message=FALSE}
library(tidyverse)
library(readxl)
```


# Problem 1

Read and clean the data, select the variable we need, and convert entry variable from character to logical variable.

```{r}
p1_df = read_csv(
  "NYC_Transit_Subway_Entrance_And_Exit_Data.csv", 
  col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>%
  janitor::clean_names() %>%
  select(
    line, station_name, station_latitude, station_longitude, 
    starts_with("route"), entry, vending, entrance_type, ada) %>%
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

#### Description
The data contains 19 variables includes line, station, name, station latitude, station longitude, 11 routes served, entry, vending, entrance type, and ADA compliance. The dimension is 19 variables and 1868 observations. First, read the csv file and select the variable we need. Then change the Route8, Route9, Route10, and Route11 variables to character variable as same as Route1 to Route7 variables.\
The data is not "tidy" since there are 11 route variables which is not necessary when we consider which route are selected. It would be easier if we combine the route variables to a new variable that contains all the route numbers. However, it would be different if we are focusing on different aspect such as while we do need to consider the station level variables.

#### Distinct stations

To find the numbers of distinct stations we need a news dataframe that has both name and line variables, and use `distinct()` funtion to obtain all unique combinations. There are 465 distinct stations in this data.

```{r}
p1_df %>% 
  select(station_name, line) %>%
  distinct
```

#### ADA Compliant Stations

To find the numbers of ADA compliant stations, we need to use the ada variable to filter out the station that satisfy the ada compliant. Then apply `distinct()` function again. There are 84 ADA compliant stations.

```{r}
p1_df %>% 
  filter(ada == TRUE) %>%
  select(station_name, line) %>%
  distinct
```

#### Proportion of station entrances/exits without vending allow entrance.

To find the proportion of station entrances/exists without vending allow entrance, we first want to filter out the entry variable without vending using `filter()` and `pull()`. After pull out the entry variable it turns to logical variable. Then we can use `mean()` to compute the proportion. The proportion is 0.3770.

```{r}
p1_df %>%
  filter(vending == "NO") %>%
  pull(entry) %>%
  mean
```

#### Numbers of dictinct stations serve A

Create two new variables route number and route name using `pivot_longer()`, then filter out distinct stations that serve A. There are 60 distinct stations that serve A.

```{r}
p1_df %>% pivot_longer(route1:route11,
                       names_to = "station_number",
                       values_to = "route_name") %>%
  filter(route_name == "A") %>%
  select(station_name, line) %>%
  distinct
```

#### Numbers of distinct stations are ADA compliant that serve A.

Similar as before, just add ADA compliant to the filter. There are 17 distinct stations are ADA compliant that serve A.

```{r}
p1_df %>% pivot_longer(route1:route11,
                       names_to = "station_number",
                       values_to = "route_name") %>%
  filter(route_name == "A", ada == TRUE) %>%
  select(station_name, line) %>%
  distinct
```


# Problem 2

Read and clean the data "Mr.Trash Wheel". Assign appropriate column name to each variables and exclude rows or columns that containing notes or non-data entries. 

```{r}
p2_df1 <- read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = 1) %>%
    janitor::clean_names() %>%
    filter(dumpster != "NA", dumpster != "Grand Total", ) %>%
    select(-c(15, 16, 17)) %>%
    mutate(sports_balls = as.integer(sports_balls))

p2_df2 <- read_excel("Trash-Wheel-Collection-Totals-7-2020-2.xlsx", sheet = 2) %>%
    janitor::clean_names() %>%
    filter(dumpster != "NA", dumpster != "Grand Total", ) %>%
    mutate(dumpster = as.character(dumpster), sports_balls = as.integer(sports_balls))
```


#### Combining two dataframe

First add new column "trash_wheel" to both dataframe, assign "mr" to Mr.Trash Wheel, and "professor" to Professor.Trash Wheel. Then use `bind_rows()` to combine two data.

```{r}
p2_df1$trash_wheel <- c("mr")
p2_df2$trash_wheel <- c("professor")
p2_df3 <- bind_rows(p2_df1, p2_df2) %>%
  janitor::clean_names()
p2_df3
```

#### Summary of these data
Mr.Trash Wheel includes amount of trash and debris collected in Inner Harbor in Baltimore from May 2014 to Jan 2021. The data has `r nrow(p2_df1)` rows and 14 variables. The key variables are date, weight in tons, volume in yards, types of trash, and estimate of homes powered by electricity from incinerated trash. Mr Trash Wheel collect total of `r p2_df1 %>% filter(year == 2020) %>% select(sports_balls) %>% sum()` sports balls in 2020.\
Professor.Trash Wheel includes amount of trash and debris collected in Canton neighborhood in Baltimore from Jan 2017 to Jan 2021. The data has `r nrow(p2_df2)` rows and 14 variables. The key variables are same as previous data. Professor TraSH Wheel collect a total weight of trash `r sum(p2_df2$weight_tons)` tons.\
The final data "p2_df3" contains all observations from Mr.Trash Wheel and Professor.Trash Wheel which has `r nrow(p2_df3)` rows and `r ncol(p2_df3)` variables. The key variables are the same as before along with extra columns that indicates whether the data is from Mr.Trash Wheel or Professor.Trash Wheel.



